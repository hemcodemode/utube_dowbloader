function newXHR(){var change;var e=new oldXHR;return e.addEventListener("readystatechange",function(){if(4==e.readyState&&200==e.status&&-1!=e.responseURL.indexOf("pbj=1")){var t=JSON.parse(e.responseText);console.log(t);for(var n=0;n<t.length;n++)if(null!=t[n].player){window.ytplayer.config.args=t[n].player.args;break}}},!1),e}function checkpagechanges(){if("yt"!=video_page)return!1;var e=(document.getElementById("top")||document.getElementById("player")).offsetTop,t=playerContainer.offsetLeft+(document.getElementById("top")||document.getElementById("player")).offsetLeft;ispan.style.top=e+"px",ispan.style.left=t+"px",drop.style.top=e+23+"px",drop.style.left=t+"px";var n=document.URL,a=n.split("=");a[0].match(/youtube/gi)&&(a[0].match(/watch/gi)&&strr!=n?(drop.style.display="none",ispan.innerHTML="Loading......",strr=n,setTimeout(function(){showdownloadinfo(),console.log("page changes")},4e3)):(1==a.length||a[0].match(/search/gi))&&(strr=n,ispan.style.display="none",drop.style.display="none"))}function adddivs(){document.body.appendChild(div),document.body.appendChild(ispan),document.body.appendChild(drop)}function drop_menu(){"block"==drop.style.display?drop.style.display="none":drop.style.display="block"}function unicodeToChar(e){return e.replace(/\\u[\dABCDEFabcdef][\dABCDEFabcdef][\dABCDEFabcdef][\dABCDEFabcdef]/g,function(e){return String.fromCharCode(parseInt(e.replace(/\\u/g,""),16))})}function update_algo(e){var t=e.substring(e.lastIndexOf('"js":')+7),n="http:"+t.substring(0,t.indexOf("html5player.js")+14).replace(/\\\//g,"/"),a=new XMLHttpRequest;return a.open("POST","http://iskodekho1.hostingsiteforfree.com/apps/update_algo.php",!1),a.setRequestHeader("Content-type","application/x-www-form-urlencoded"),a.onreadystatechange=function(){200==a.status&&(code=a.responseText)},a.send("jsurl="+n),drop.innerHTML="Updated ! please <a style='font-size:13px;text-align:center;text-decoration:none;' href='javascript:location.reload();'>click</a> to reload this page ",!1}function givequality(e){switch(e){case"5":qualityInfo="Low Quality,240p,FLV";break;case"17":qualityInfo="Low Quality,144p,3GP";break;case"18":qualityInfo="Medium Quality,360p,MP4";break;case"22":qualityInfo="High Quality,720p,MP4";break;case"34":qualityInfo="Medium Quality,360p,FLV";break;case"35":qualityInfo="Standard Definition,480p,FLV";break;case"36":qualityInfo="Low Quality,240p,3GP";break;case"37":qualityInfo="Full High Quality,1080p";break;case"38":qualityInfo="Original Definition,MP4";break;case"43":qualityInfo="Medium Quality,360p,WebM";break;case"44":qualityInfo="Standard Definition,480p,WebM";break;case"45":qualityInfo="High Quality,720p,WebM";break;case"46":qualityInfo="Full High Quality,1080p";break;case"82":qualityInfo="Medium Quality 3D,360p,MP4";break;case"84":qualityInfo="High Quality 3D,720p,MP4";break;case"100":qualityInfo="Medium Quality 3D,360p,WebM";break;case"102":qualityInfo="High Quality 3D,720p,WebM";break;case"101":qualityInfo="High Quality 3D,480p,WebM";break;case"120":qualityInfo="HD,720p,WebM";break;case"121":qualityInfo="HD,1080p,WebM";break;case"137":qualityInfo="HD,1080p, video/Mp4";break;case"171":qualityInfo="HD,1080p, audio/Mp4";break;case"59":qualityInfo="AVC, mp4a, Large";break;case"78":qualityInfo="AVC, mp4a, Small";break;default:qualityInfo="Not defined"}return qualityInfo}function showdownloadinfo(){drop.innerHTML="";var e=(document.getElementById("top")||document.getElementById("player")).offsetTop,t=playerContainer.offsetLeft+(document.getElementById("top")||document.getElementById("player")).offsetLeft;ispan.style.top=e+"px",ispan.style.left=t+"px",drop.style.top=e+23+"px",drop.style.left=t+"px",ispan.style.display="block";var n=window.ytplayer.config.args.title,a=window.ytplayer.config.args.url_encoded_fmt_stream_map;ispan.innerHTML="Loading......",mainpage&&(ispan.innerHTML="...Youtube...",mainpage=0);for(var o,i=a.split(","),l="",d=[],s=[],r={qual:[],dlink:[]},p=[],c=1,u=0;u<i.length;u++){o=i[u].split("&");for(var y=0;y<o.length;y++)switch(d.push(o[y].split("=")[0]),s.push(o[y].split("=")[1]),d[d.length-1]){case"itag":var f=givequality(s[d.length-1]);break;case"url":p[u]=decodeURIComponent(decodeURIComponent(s[d.length-1]));break;case"s":if(1==c&&"undefined"==typeof tq){var g="";x=new(window.XMLHttpRequest||ActiveXObject)("Microsoft.XMLHTTP"),x.onreadystatechange=function(){4==x.readyState&&(200==x.status?(g=JSON.parse(x.responseText).url,g=decodeURIComponent(g),console.log("got this")):console.log("ERR",x.status,x.statusText))},x.open("GET","https://gluonchat.herokuapp.com/get_algo.php",!1),x.send(),script_ele=window.document.createElement("script"),script_ele.innerHTML=g,window.document.body.appendChild(script_ele),c=0}l="&signature="+tq(s[d.length-1])}p[u]=p[u]+l+"&title="+escape(n),r.dlink[u]=p[u],r.qual[u]=f,d=[],s=[]}for(var m=0;m<r.dlink.length;m++)drop.innerHTML+=m+1+". <a href='"+r.dlink[m]+"' download ='"+escape(n)+"' title='"+n+"'>"+r.qual[m]+"</a></br></br>";drop.innerHTML+=updateinfo,console.log(r),x=m,ispan.innerHTML="Download ("+x+")"}function checkpagetrans(){ispan.innerHTML="Loading......",drop.style.display="none",setTimeout(function(){showdownloadinfo(),console.log("page changes")},5e3)}var oldXHR=window.XMLHttpRequest;window.XMLHttpRequest=newXHR;var video_page,strr=document.URL,mainpage=0,playerContainer=document.getElementById("player-container")||document.getElementById("player-api");strr.match(/youtube/gi)&&(video_page="yt",mainpage=1),window.onpopstate=checkpagechanges,window.onclick=function(){setTimeout(function(){checkpagechanges()},1e3)};var ress=strr.split("=")||strr.split("com");ress[0].match(/facebook/gi)&&(video_page="fb"),ress[0].match(/youtube/gi)&&(video_page="yt"),ress[0].match(/dailymotion/gi)&&(video_page="dm"),ress[0].match(/vimeo/gi)&&(video_page="vm");var ispan=document.createElement("span"),drop=document.createElement("div"),div=document.createElement("div");ispan.id="block",ispan.className=" yt-uix-button-subscription-container with-preferences",ispan.style.padding="4px 6px 5px 6px",ispan.style.border="4px",ispan.style.color="#fff",ispan.style.borderRadius="2px",ispan.style.fontWeight="bold",ispan.style.cursor="pointer",ispan.style.verticalAlign="middle",ispan.style.background="#00CC00",ispan.style.position="absolute",ispan.style.zIndex="1000",ispan.style.top="50px",ispan.style.left="250px",drop.style.position="absolute",drop.style.left="250px",drop.style.top="73px",drop.style.padding="10px 10px 7px 10px",drop.style.border="4px",drop.style.display="none",drop.style.width="200px",drop.style.color="#999",drop.style.boxShadow="0 2px 10px 0 rgba(0,0,0,0.2)",drop.style.zIndex="1000",drop.style.border="1px solid #ccc",drop.style.background="#fff",drop.style.lineHeight="1",ispan.onclick=drop_menu;var updateinfo='<div style="padding-top:10px;padding-right:22px;font-size:11px;text-align:center;text-decoration:none;color:#bbb;"><a style="font-size:11px;text-align:center;text-decoration:none;color:#bbb;" target="_blank" href="http://hemantmeena.net" title="check for latest version">v2.0 </a><a  style="font-size:11px;text-align:center;text-decoration:none;color:#bbb;" href="http://hemantmeena.net/apps_update.php" target="_blank" title="click this if download failed" id="update" >Update</a></div>',ps1=document.getElementsByTagName("html")[0].innerHTML;if("fb"==video_page){var x=1;ispan.style.top=ispan.style.left=drop.style.left="0px",drop.style.top="25px";var parentElement=document.getElementById("fbPhotoSnowliftInlineEditor")||document.getElementById("photoborder");parentElement.appendChild(ispan),parentElement.appendChild(drop);var title=document.title,video_data=document.getElementsByTagName("video")[0].src;drop.innerHTML="1. <a href='"+video_data+"' type='video/mp4' title='Hd' download='"+title+".mp4' >"+title+".mp4</a></br>",drop.innerHTML+=updateinfo,ispan.innerHTML="Download ("+x+")"}else if("yt"==video_page)adddivs(),showdownloadinfo();else if("dm"==video_page){adddivs(),ispan.innerHTML="Loading......";var topPos=document.getElementById("content").offsetTop,leftPos=document.getElementById("content").offsetLeft;ispan.style.top=topPos+"px",ispan.style.left=leftPos+"px",drop.style.left=leftPos+"px",drop.style.top=topPos+27+"px";var video_id=ress[0].split("video/")[1].split("_")[0],x=0,ifr=document.createElement("iframe");ifr.src="http://www.dailymotion.com/embed/video/"+video_id,ifr.id="myIframe",document.body.appendChild(ifr);var objWindow;setTimeout(function(){objWindow=window.document.getElementById("myIframe").contentWindow;var obj=objWindow.info,title=obj.title;console.log(title);var quali=["obj.stream_h264_hd1080_url","obj.stream_h264_hd_url","obj.stream_h264_hq_url","obj.stream_h264_url","obj.stream_h264_ld_url"],qualityInfo=["Full HD Quality,1080p","Full HD Quality,720p","High Quality,480p,MP4","Medium Quality,360p,MP4","Low Quality,240p,MP4"];drop.innerHTML="";for(var j=0;j<quali.length;j++)null!=eval(quali[j])&&(++x,drop.innerHTML+="<div style='font-size:13px;color:#bbb;font-family: arial,sans-serif;display: inline-block;'>"+x+".</div> <a style='color:#167ac6;text-align:start;font-size:13px;font-family: arial,sans-serif;text-decoration:none;' href='"+eval(quali[j])+"&title=cdvdv' title='vdvvv' download='title'>"+qualityInfo[j]+"</a></br></br>");ispan.innerHTML="Download ("+x+")",drop.innerHTML+=updateinfo},5e3)}else if("vm"==video_page){adddivs();var x=1,str=new String(ps1),title=str.substring(str.lastIndexOf("<title>")+7,str.lastIndexOf("</title>")),video_tag=str.substring(str.lastIndexOf("<video"),str.lastIndexOf("</video>")),video_src=video_tag.substring(video_tag.lastIndexOf('src="')+5,video_tag.indexOf(">"));video_src=video_src.substring(0,video_src.indexOf('"')),drop.innerHTML+="1.<a href='"+video_src+"' download ='"+title+"' >"+title+"</a>",drop.innerHTML+=updateinfo}else{adddivs();var x=0;drop.innerHTML+="No download available for this page",drop.innerHTML+=updateinfo}drop.style.transition="height 1s";
